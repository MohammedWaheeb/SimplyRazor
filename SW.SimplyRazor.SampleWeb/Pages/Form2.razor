@page "/form2"
@inject NavigationManager navigationManager

<SimplyAlertHub></SimplyAlertHub>

<SimplyQuery QueryUrl="https://localhost:5001/cqapi/employees/" Key="5" @bind-Value="employee" @bind-Ready="ready" />

<SimplyReady @bind-Ready="ready">

    <SimplyForm @bind-Value="employee">

        <SimplyField Name="FirstName"></SimplyField>
        <SimplyField Name="LastName"></SimplyField>

        <SimplyField Name="@nameof(Employee.Age)" />
        <div>test</div>
        <SimplyField Name="Married" />
        <SimplyField Name="EmploymentStatus" Lookup="https://localhost:5001/cqapi/mockmodels/" />
        <SimplyField Name="Country" Lookup="https://localhost:5001/cqapi/countries/" />
        <SimplyField Name="Photo" />

        <SimplyField Name="Salary.Amount" />
        <SimplyField Name="Salary.Currency" />
    </SimplyForm>

    <h1>Leaves</h1>

    <SimplyTable @bind-Value="employee.Leaves">
        <Header>
            <SimplyAction Type="ActionType.TableAdd" />
        </Header>
        <Columns>
            <SimplyField Name="Reason" />
            <SimplyField Name="Days"  />
        </Columns>
        <Form>
            <SimplyField Name="Reason" />
            <SimplyField Name="Days"  />
        </Form>
    </SimplyTable>

    <div class="container-fluid mt-5">
        <SimplyCommand Text="Save" CommandUrl="https://localhost:5001/cqapi/employees/" Key="5" Request="employee" OnSuccess="SaveOnSuccess" />
    </div>

    <p>Age: @employee?.Age</p>
    <p>Emp Status: @employee?.EmploymentStatus</p>
    <p>Country: @employee?.Country</p>
    <p>Photo: @employee?.Photo</p>

</SimplyReady>

@code {

    Employee employee;
    bool ready;

    void SaveOnSuccess(object obj)
    {
        navigationManager.NavigateTo("/");
    }

}
