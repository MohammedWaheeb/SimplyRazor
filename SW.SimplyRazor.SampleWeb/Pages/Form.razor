@page "/form"
@inject NavigationManager navigationManager

<SimplyAlertHub></SimplyAlertHub>

<SimplyQuery QueryUrl="https://localhost:5001/cqapi/employees/" Key="5" @bind-Value="employee" @bind-Ready="ready" />

<SimplyReady @bind-Ready="ready">

    <SimplyForm @bind-Value="employee">

        <FieldGroup>
            <SimplyField Name="FirstName" readonly></SimplyField>
            <SimplyField Name="LastName"></SimplyField>
        </FieldGroup>
        <SimplyTable Name="Leaves" TModel="Leave">
            <Header>
                <SimplyAction Type="ActionType.TableAdd" />
            </Header>
            <Fields>
                <SimplyField Name="Reason" />
                <SimplyField Name="Days" min="1" max="100" pattern="[0-9]{5}" />
            </Fields>
        </SimplyTable>
        <SimplyField Name="Age" />
        <SimplyField Name="Married" />
        <SimplyField Name="EmploymentStatus" Lookup="https://localhost:5001/cqapi/mockmodels/" />
        <SimplyField Name="Country" Lookup="https://localhost:5001/cqapi/countries/" />
        <SimplyField Name="Photo" />

        <FieldGroup>
            <SimplyField Name="Salary.Amount" />
            <SimplyField Name="Salary.Currency" />
        </FieldGroup>


    </SimplyForm>

    <div class="container-fluid mt-5">
        <SimplyCommand Text="Save" CommandUrl="https://localhost:5001/cqapi/employees/" Key="5" Request="employee" OnSuccess="SaveOnSuccess" />
    </div>


    <p>Age: @employee?.Age</p>
    <p>Emp Status: @employee?.EmploymentStatus</p>
    <p>Country: @employee?.Country</p>
    <p>Photo: @employee?.Photo</p>

</SimplyReady>

@code {

    Employee employee;
    bool ready;

    async Task SaveOnSuccess(object obj)
    {
        navigationManager.NavigateTo("/");
    }



}
